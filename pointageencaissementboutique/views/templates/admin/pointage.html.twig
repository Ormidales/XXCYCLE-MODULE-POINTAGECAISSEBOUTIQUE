{% extends '@PrestaShop/Admin/layout.html.twig' %}

{% block content %}

<script src="https://cdn.tailwindcss.com"></script>

<style>
table,
td {
    border: 1px solid #333;
	padding: 5px;
}

thead,
tfoot {
    background-color: #333;
    color: #fff;
	padding: 5px;
}
textarea {
  resize: vertical;
}
</style>

	<div class="w-full bg-gray-50 p-3 rounded-lg">
		<div class="w-full px-3 py-2 bg-gray-600 flex items-center mb-4 rounded-lg">
			<p class="text-white text-[20px]">Date</p>
			<form class="ml-3 flex inline">
				<input type="date" class="w-[40vh] h-[3vh]">
				<select class="ml-2 w-[15vh] h-[3vh]">
					<option>ESPECE</option>
					<option>CARTE BLEU</option>
					<option>CHEQUE</option>
				</select>
				<select class="ml-2 w-[15vh] h-[3vh]">
					<option>Boutique</option>
				</select>
				<input type="submit" value="Charger" class="ml-2 bg-blue-500 px-4 py-1 rounded-lg text-white">
			</form>
		</div>
		<p class="text-black text-[16px]">Liste des encaissements :</p>
		<div class="w-full flex gap-3">
			<div class="w-3/4">
				<table class="w-full rounded-lg">
					<thead>
						<tr>
							<th>Mode</th>
							<th>Type</th>
							<th class="flex items-center justify-between">
								<p>Montant</p>
								<div>
									<p class="hidden">0</p>
									<input id="select-all" type="checkbox">
								</div>
							</th>
							<th>Montant Encaissé</th>
							<th>Facture</th>
							<th>Date</th>
							<th>Vendeur</th>
						</tr>
					</thead>
					<tbody>
					{% for item in data %}
    					{% set orderViewUrl = getAdminLink('AdminOrders', true, {'id_order': item.id_order, 'vieworder': 1}) %}			
						<tr>
							<td>
								<select class="w-[12vh] h-[3vh]">
									<option>ESPECE</option>
									<option>CARTE BLEU</option>
									<option>CHEQUE</option>
								</select>
							</td>
							<td>FACTURE</td>
							<td>
								<div class="w-full flex inline items-center justify-between">
									<p>200.00</p>
									<input type="checkbox">
								</div>
							</td>
							<td>
								<div class="w-full">
									<input type="text" value="200.00" class="border border-black">
								</div>
							</td>
							<td>{{item.id_order}}</td>
							<td>10/11/2022</td>
							<td>juliengabriel</td>
						</tr>
					{% endfor %}
					</tbody>
				</table>
			</div>
			<div class="w-1/4 sticky top-5">
				<div class="w-full border border-black rounded-lg bg-gray-100">
					<div class="w-full flex items-center justify-between border-b border-black px-4 py-2">
						<p class="text-black text-[14px]">Nombre de Tickets</p>
						<p class="text-black text-[14px] font-bold">4</p>
					</div>
					<div class="w-full flex items-center justify-between border-b border-black px-4 py-2">
						<p class="text-black text-[14px]">Total Théorique</p>
						<p class="text-black text-[14px] font-bold">598.94</p>
					</div>
					<div class="w-full flex items-center justify-between border-b border-black px-4 py-2">
						<p class="text-black text-[14px]">Total Coché</p>
						<div class="flex items-center">
							<p id="total" class="text-black text-[14px] font-bold">0.00</p>
							<p class="text-black text-[14px] font-bold ml-1">€</p>
						</div>
					</div>
					<div class="w-full flex items-center justify-between border-b border-black px-4 py-2">
						<p class="text-black text-[14px]">Différence</p>
						<p class="text-black text-[14px] font-bold">598.94</p>
					</div>
					<div class="w-full px-4 py-2 pb-4">
						<p class="text-black text-[14px]">Commentaire</p>
						<textarea class="mt-2 w-full h-[20vh] border border-black"></textarea>
						<input type="submit" value="Valider" class="mt-2 bg-blue-500 px-3 py-1 rounded-lg text-white">
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
  // Écoutez les changements dans les cases à cocher
  document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', updateTotal);
  });

  function updateTotal() {
    // Sélectionnez toutes les cases à cocher cochées
    const checkedCheckboxes = document.querySelectorAll('input[type="checkbox"]:checked');

    // Ajouter les valeurs correspondantes des cases à cocher cochées
    let total = 0;
    checkedCheckboxes.forEach(checkbox => {
      // Obtenez la valeur de l'élément parent de la case à cocher.
      const amount = checkbox.parentElement.querySelector('p').innerText;
      total += parseFloat(amount);
    });

    // Afficher le total
    document.querySelector('#total').innerText = total;
  }
  // Écoutez les clics sur la case à cocher "select-all".
  document.querySelector('#select-all').addEventListener('click', selectAll);

  function selectAll() {
    // Sélectionnez toutes les cases à cocher.
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');

    // Cocher ou décocher toutes les cases à cocher en fonction de l'état de la case à cocher "Sélectionner tout".
    const isChecked = document.querySelector('#select-all').checked;
    checkboxes.forEach(checkbox => {
      checkbox.checked = isChecked;
    });
  }
</script>

{% endblock %}